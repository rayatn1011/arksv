var M=Object.defineProperty;var P=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var I=(c,i,s)=>i in c?M(c,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):c[i]=s,g=(c,i)=>{for(var s in i||(i={}))V.call(i,s)&&I(c,s,i[s]);if(P)for(var s of P(i))q.call(i,s)&&I(c,s,i[s]);return c};import{o as p,c as m,a as l,a9 as A,r as D,O as N,m as j,v as U,aH as z,aI as O,b as a,w as d,aa as b,Y as h,ab as _}from"./index.76a9201e.js";import{E as F,a as H,_ as G}from"./el-table-column.724790a4.js";import"./el-scrollbar.559b41aa.js";import{_ as Q}from"./cancel.5a473f63.js";import"./debounce.e3dc74f1.js";import"./index2.6b7e3edd.js";const R={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px"},S=l("path",{d:"M0 0h24v24H0V0z",fill:"none"},null,-1),Y=l("path",{d:"M18 7l-1.41-1.41-6.34 6.34 1.41 1.41L18 7zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12-1.42-1.41zM.41 13.41L6 19l1.41-1.41L1.83 12 .41 13.41z"},null,-1),J=[S,Y];function K(c,i){return p(),m("svg",R,J)}var W={name:"custom-done-all",render:K};const X={class:"mb-8"},Z={class:"grid grid-cols-[repeat(2,_minmax(0,_max-content))] gap-4"},ee=l("label",{for:"userId",class:"mb-2 ml-1 block select-none text-sm text-gray-600"},"\u500B\u4EBAID",-1),te=["value"],ae=l("label",{for:"userName",class:"mb-2 ml-1 block select-none text-sm text-gray-600"},"\u540D\u7A31",-1),oe=["value"],le=l("span",{class:"text-base font-bold"},"\u793E\u7FA4\u5E02\u96C6",-1),ne=["src"],re={key:0},se={key:1},ie={class:"flex justify-center gap-2"},de=["disabled","onClick"],ce=h(" \u78BA\u8A8D\u4EA4\u6613 "),ue=["onClick"],pe=h(" \u53D6\u6D88 "),me=l("span",{class:"text-base font-bold"},"\u5B98\u65B9\u5E02\u96C6",-1),be=["src"],_e={key:0},he={key:1},fe={class:"flex justify-center gap-2"},ye=["disabled","onClick"],ge=h(" \u78BA\u8A8D\u4EA4\u6613 "),we=["onClick"],ve=h(" \u53D6\u6D88 "),Pe={name:"MarketUserMyBooked",setup(c){const i=A(),s=D(i.state.auth.userInfo),w=D("community"),v=[{label:"\u6B66\u5668",value:"weapon"},{label:"\u9632\u5177",value:"armor"},{label:"\u9053\u5177",value:"props"},{label:"\u8CC7\u6E90",value:"resource"},{label:"\u5176\u4ED6",value:"other"}],x=[{label:"\u539F\u59CB",value:"primitive"},{label:"\u666E\u901A",value:"ramshackle"},{label:"\u512A\u79C0",value:"apprentice"},{label:"\u7CBE\u826F",value:"journeyman"},{label:"\u53F2\u8A69",value:"mastercraft"},{label:"\u50B3\u8AAA",value:"ascendan"}],u=N({community:[],formatedCommunity:j(()=>u.community.map(o=>{let e=g({},o),t=v.find(n=>n.value===o.class);if(t&&(e.type=t.label,e.qualityLabel=x.find(n=>n.value===o.quality).label),e.getTanPlList){for(let n of e.getTanPlList)if(n.gameid===s.value.id){e.isComp=n.isComp,e.number=n.number;break}delete e.getTanPlList}return e.dealContent=o.money?`\u6AFB\u82B1\u5E63 $${o.money}`:o.money_item,e})),official:[],formatedOfficial:j(()=>u.official.map(o=>{let e=g({},o),t=v.find(n=>n.value===o.class);if(t&&(e.type=t.label,e.qualityLabel=x.find(n=>n.value===o.quality).label),e.getTanPlList){for(let n of e.getTanPlList)if(n.gameid===s.value.id){e.isComp=n.isComp,e.number=n.number;break}delete e.getTanPlList}return e.dealContent=o.money?`\u6AFB\u82B1\u5E63 $${o.money}`:o.money_item,e}))}),f=async()=>{let o=new FormData;o.append("getGmidOrder",s.value.id),o.append("getTanPlList",1),await Promise.all([b({method:"post",url:"getTanListApi.php",headers:{"Content-Type":"multipart/form-data"},data:o}),b({method:"post",url:"getRootTanListApi.php",headers:{"Content-Type":"multipart/form-data"},data:o})]).then(e=>{u.community=e[0].data,u.official=e[1].data}).catch(e=>{alert("\u53D6\u5F97\u5DF2\u4E0B\u8A02\u7684\u5546\u54C1\u6E05\u55AE\u5931\u6557"),console.error(e)})},C=async o=>{let e=new FormData;e.append("tanid",o.tanid),await b({method:"post",url:`transactionCompleteApi.php?tanum=${o.number}`,headers:{"Content-Type":"multipart/form-data"},data:e}).then(async t=>{t.data.isPass?(await f(),await i.dispatch("getUserInfo"),_.success("\u4EA4\u6613\u6210\u529F")):_.error("\u4EA4\u6613\u5931\u6557")}).catch(t=>{alert("\u8CB7\u5BB6\u78BA\u8A8D\u4EA4\u6613\u5931\u6557"),console.error(t)})},k=async o=>{let e=new FormData;e.append("tanid",o.tanid),await b({method:"post",url:`cancelTradeApi.php?tanum=${o.number}`,data:e}).then(async t=>{t.data.isPass?(await f(),await i.dispatch("getUserInfo"),_.success("\u6210\u529F\u53D6\u6D88\u4E0B\u8A02")):_.error("\u53D6\u6D88\u4E0B\u8A02\u5931\u6557")}).catch(t=>{alert("\u8CB7\u5BB6\u53D6\u6D88\u4EA4\u6613\u5931\u6557"),console.error(t)})};return U(()=>{f()}),(o,e)=>{const t=F,n=G,T=W,L=Q,B=H,$=z,E=O;return p(),m("div",null,[l("section",X,[l("ul",Z,[l("li",null,[ee,l("input",{id:"userId",type:"text",autocomplete:"off",value:s.value.id,readonly:"",class:"w-full rounded-md border border-gray-100 bg-gray-200 px-3 py-2 transition focus:border-brand focus:outline-none"},null,8,te)]),l("li",null,[ae,l("input",{id:"userName",type:"text",autocomplete:"off",value:s.value.name,readonly:"",class:"w-full rounded-md border border-gray-100 bg-gray-200 px-3 py-2 transition focus:border-brand focus:outline-none"},null,8,oe)])])]),l("section",null,[a(E,{modelValue:w.value,"onUpdate:modelValue":e[0]||(e[0]=r=>w.value=r)},{default:d(()=>[a($,{name:"community"},{label:d(()=>[le]),default:d(()=>[a(B,{data:u.formatedCommunity,border:"","max-height":"480",style:{width:"100%"}},{default:d(()=>[a(t,{prop:"title",label:"\u5546\u54C1\u5716\u7247",width:"80"},{default:d(r=>[l("div",null,[l("img",{src:r.row.icon,class:"max-w-[4rem] border bg-white p-1"},null,8,ne)])]),_:1}),a(t,{prop:"title",label:"\u5546\u54C1\u540D\u7A31","min-width":"120"}),a(t,{prop:"isBlueprint",label:"\u85CD\u5716",width:"60"},{default:d(r=>[r.row.isBlueprint?(p(),m("div",re,[a(n,{class:"mx-auto text-green-700"})])):(p(),m("div",se))]),_:1}),a(t,{prop:"type",label:"\u985E\u5225",width:"60"}),a(t,{prop:"qualityLabel",label:"\u54C1\u8CEA",width:"60"}),a(t,{prop:"message",label:"\u5546\u54C1\u5167\u5BB9","min-width":"120"}),a(t,{prop:"dealContent",label:"\u4EA4\u63DB\u65B9\u5F0F","min-width":"120"}),a(t,{fixed:"right",label:"\u64CD\u4F5C",align:"center",width:"240"},{default:d(r=>[l("div",ie,[l("button",{type:"button",class:"flex items-center justify-center rounded-full border bg-white px-2 py-1 transition hover:border-brand hover:bg-brand hover:text-white disabled:border-gray-300 disabled:bg-gray-200 disabled:text-gray-400",disabled:!r.row.isComp,onClick:y=>C(r.row)},[a(T,{class:"mr-2"}),ce],8,de),l("button",{type:"button",class:"flex items-center justify-center rounded-full border bg-white px-2 py-1 transition hover:border-brand hover:bg-brand hover:text-white",onClick:y=>k(r.row)},[a(L,{class:"mr-2"}),pe],8,ue)])]),_:1})]),_:1},8,["data"])]),_:1}),a($,{name:"official"},{label:d(()=>[me]),default:d(()=>[a(B,{data:u.formatedOfficial,border:"","max-height":"480",style:{width:"100%"}},{default:d(()=>[a(t,{prop:"title",label:"\u5546\u54C1\u5716\u7247",width:"80"},{default:d(r=>[l("div",null,[l("img",{src:r.row.icon,class:"max-w-[4rem] border bg-white p-1"},null,8,be)])]),_:1}),a(t,{prop:"title",label:"\u5546\u54C1\u540D\u7A31","min-width":"120"}),a(t,{prop:"isBlueprint",label:"\u85CD\u5716",width:"60"},{default:d(r=>[r.row.isBlueprint?(p(),m("div",_e,[a(n,{class:"mx-auto text-green-700"})])):(p(),m("div",he))]),_:1}),a(t,{prop:"type",label:"\u985E\u5225",width:"60"}),a(t,{prop:"qualityLabel",label:"\u54C1\u8CEA",width:"60"}),a(t,{prop:"message",label:"\u5546\u54C1\u5167\u5BB9","min-width":"120"}),a(t,{prop:"dealContent",label:"\u4EA4\u63DB\u65B9\u5F0F","min-width":"120"}),a(t,{fixed:"right",label:"\u64CD\u4F5C",align:"center",width:"240"},{default:d(r=>[l("div",fe,[l("button",{type:"button",class:"flex items-center justify-center rounded-full border bg-white px-2 py-1 transition hover:border-brand hover:bg-brand hover:text-white disabled:border-gray-300 disabled:bg-gray-200 disabled:text-gray-400",disabled:!r.row.isComp,onClick:y=>C(r.row)},[a(T,{class:"mr-2"}),ge],8,ye),l("button",{type:"button",class:"flex items-center justify-center rounded-full border bg-white px-2 py-1 transition hover:border-brand hover:bg-brand hover:text-white",onClick:y=>k(r.row)},[a(L,{class:"mr-2"}),ve],8,we)])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1},8,["modelValue"])])])}}};export{Pe as default};
